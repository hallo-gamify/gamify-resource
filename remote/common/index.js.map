{"version":3,"sources":["../file:/D:/PROJECTs/GAMIFY/gamify-templates/assets/remote/common/scripts/file:/D:/PROJECTs/GAMIFY/gamify-templates/assets/remote/common/scripts/LobbyPopup.ts","../file:/D:/PROJECTs/GAMIFY/gamify-templates/assets/remote/common/scripts/ui/file:/D:/PROJECTs/GAMIFY/gamify-templates/assets/remote/common/scripts/ui/PlayerInboxButton.ts","../file:/D:/PROJECTs/GAMIFY/gamify-templates/assets/remote/common/scripts/ui/file:/D:/PROJECTs/GAMIFY/gamify-templates/assets/remote/common/scripts/ui/PlayerInboxItem.ts","../file:/D:/PROJECTs/GAMIFY/gamify-templates/assets/remote/common/scripts/network/file:/D:/PROJECTs/GAMIFY/gamify-templates/assets/remote/common/scripts/network/PlayerInboxNetwork.ts","../file:/D:/PROJECTs/GAMIFY/gamify-templates/assets/remote/common/scripts/file:/D:/PROJECTs/GAMIFY/gamify-templates/assets/remote/common/scripts/PlayerInboxPopup.ts","../file:/D:/PROJECTs/GAMIFY/gamify-templates/assets/remote/common/scripts/types/file:/D:/PROJECTs/GAMIFY/gamify-templates/assets/remote/common/scripts/types/PlayerInboxType.ts"],"names":["_decorator","ccclass","property","GamifyComponent","importRemoteCCClass","LobbyPopupStatus","_dec","remoteCCClass","_dec2","type","Color","_dec3","SpriteFrame","_dec4","serializable","_dec5","ServiceRequestConfig","_descriptor","_applyDecoratedDescriptor","_class2","_GamifyComponent","LobbyPopup","_this","_len","arguments","length","args","Array","_key","call","apply","concat","_initializerDefineProperty","_assertThisInitialized","_descriptor2","_descriptor3","_descriptor4","servieNetworkName","fillImgWrapper","lobbyURL","_inheritsLoose","_proto","prototype","onData","state","action","_networkState","_networkState2","_networkState3","_networkState4","networkState","actionType","payload","API_ACTION","AUTH_RESULT","log","MainGameAction","INIT","apiService","this","getAPIData","enableLobby","sys","isMobile","config","homeButton","urlSearchParams","URLSearchParams","window","location","search","get","isURLValid","decodeURIComponent","status","SETUP_COMPLETED","render","serviceRequest","ResponseAction","onRender","_onRender","_asyncToGenerator","_regeneratorRuntime","mark","_callee","done","capturedState","sharedData","wrap","_context","prev","next","t0","request","abrupt","hidePopup","displayHomeButton","setButtonColor","buttonColor","toString","stop","_x","_x2","_x3","serviceName","serviceData","error","urlStr","undefined","showPopup","_showPopup","_callee2","useEffect","uiOpacity","_context2","node","getComponent","UIOpacity","addComponent","children","forEach","childNode","active","Tween","stopAllByTarget","Promise","resolve","tween","set","opacity","to","start","_x4","_hidePopup","_callee3","_this2","_context3","_x5","homeIcon","styleSheet","document","createElement","innerText","head","appendChild","className","fillImg","src","texture","addEventListener","onHomeButtonPressed","bind","body","colorStr","isLobbyEnabled","match","classList","add","_onHomeButtonPressed","_callee4","_context4","onCancelButtonPressed","_onCancelButtonPressed","_callee5","_context5","onOKButtonPressed","_onOKButtonPressed","_callee6","_context6","replace","configurable","enumerable","writable","initializer","_class","_RF","pop","SpineClip","_FloatButton","PlayerInboxButton","_animation","onLoad","animation","onPress","_onPress","event","play","onEnable","_createClass","key","value","FloatButton","Object","getOwnPropertyDescriptor","Label","_class3","_Eventify","PlayerInboxItem","data","_isActive","update","deltaTime","claimBefore","isActive","timeRemaining","getTime","Date","now","expireTimeTitle","string","convertMsToTime","isRead","rewardTitle","count","onClaimReward","emit","EVENT","SELECTED","updateExpireTime","milliseconds","seconds","Math","floor","minutes","hours","days","padTo2Digits","num","padStart","onDestroy","targetOff","getComponentsInChildren","Sprite","sp","grayscale","getComponentInChildren","Button","interactable","Eventify","Component","PlayerInboxNetworkState","_WebSocketComponent","PlayerInboxNetwork","initNetworkState","connect","_url","_initNetworkState","wssURL","getStartDateParam","paramKey","date","getFullYear","getMonth","getDate","toISOString","getEndDateParam","onMessage","client","dispatch","PlayerInboxAction","UPDATE_INBOX","onError","WebSocketComponent","Helper","js","getClassByName","readonly","Node","group","_dec6","_dec7","_dec8","displayName","_dec9","Prefab","_dec10","RemoteMultilingualTextPackage","_dec11","_dec12","_dec13","_dec14","_dec15","_AsyncWaitify","PlayerInboxPopup","_descriptor5","_descriptor6","_descriptor7","_descriptor8","_descriptor9","_descriptor10","_descriptor11","_descriptor12","_descriptor13","_descriptor14","_selectedItemInfo","servieName","_continue","allowActionTypes","SETTING","CLAIM","SHOW","HIDE","onInit","readyStates","waitForReady","then","PlayerInboxStatus","SHOW_ICON_VIEW","onStoreRegisted","senderIsMe","hasOtherState","waitForStore","sender","indexOf","ready","checkAndUpdateClaimmingState","implementSettingState","SHOW_INBOX_VIEW","READY","isNumber","HIDE_VIEW","claimed","create","url","SHOW_CONTINUE_VIEW","UPDATE","AUTO_SPIN","showIconViewRender","showInboxViewRender","requestInboxStateRender","requestClaimmingStateRender","updateAutoSpinSettingRender","showContinuePopupRender","executeSpinStateRender","getOtherState","playerReward","getClaimedRewards","claimedInfo","getClaimInfoFromRewardData","_claimedInfo$data","_claimedInfo$data2","isStoreRegisted","warn","waitFor","lastStatus","_requestInboxStateRender","listingService","sent","renderInboxList","_requestClaimmingStateRender","_capturedState$claime","_capturedState$claime2","claimUrl","_claimedInfo","claimService","_updateAutoSpinSettingRender","_state$claimed","rewardCount","betSetting","isUnstopable","isUnstoppable","autoSpinNumber","betConfig","_executeSpinStateRender","SPIN","_x6","_showContinuePopupRender","_this3","curtain","playerInboxPanel","closeButton","continueNotication","dragButton","_x7","_showInboxViewRender","_callee7","_context7","_x8","_showIconViewRender","_callee8","_context8","_x9","claimedReward","searchValue","isArray","find","reward","getPlayMode","spinData","spin","numOfFreeSpin","freeSpins","id","rewardData","isString","JSON","parse","claimId","_renderInboxList","_callee9","_networkState$config","_networkState$config2","domain","playerToken","inboxList","_context9","playerInbox","emptyNotication","elementData","index","inboxInfo","createMap","module","push","sort","a","b","timeA","timeB","updateInboxHistoryRender","_x10","_updateInboxHistoryRender","_callee10","_this4","_context10","inboxContainer","itemPrefab","languagePackage","removeAllChildren","itemName","itemNode","getChildByName","instantiate","parent","name","item","on","onClaimItem","_x11","_onClaimItem","_callee11","itemInfo","_context11","_x12","onPressIconButton","onPressCloseButton","onPressOkButton","getCurrentRewardId","getCurrentModule","getIsFunParam","AsyncWaitify","GamePopup","UPDATE_SETTING"],"mappings":"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","file":"all.js","sourcesContent":["import { _decorator, Component, Node } from 'cc';\r\nimport { importRemoteCCClass, remoteCCClass } from 'db://assets/Scripts/gamify/utils/RemoteScriptImporter';\r\nimport { IGamifyComponent } from '../../../Scripts/gamify/interfaces/IComponent';\r\nimport { Action } from '../../../Scripts/gamify/core/Action';\r\nimport { SpriteFrame } from 'cc';\r\nimport { Color } from 'cc';\r\nimport { log } from 'cc';\r\nimport { sys } from 'cc';\r\nimport { API_ACTION, MainGameAction } from '../../../Scripts/ui/actions/StartActions';\r\nimport { error } from 'cc';\r\nimport { DEV } from 'cc/env';\r\nimport { tween } from 'cc';\r\nimport { Tween } from 'cc';\r\nimport { UIOpacity } from 'cc';\r\nimport { ServiceRequestConfig } from '../../../Scripts/ui/api/ServiceRequestConfig';\r\nimport { APIServiceAdaptor } from '../../../Scripts/ui/api/APIServiceAdaptor';\r\nimport { SpriteAtlas } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\nconst CSSButtonStyle = `.lobbyBtn{width:60px;height:60px;position:absolute;right:0;top:0;margin-top:20px;margin-right:20px;border-radius:50%;background-color:#763a00;padding:0;border:0;}.lobbyBtn:hover{background-color:#fca14c;}.lobbyBtn:active{background-color:#4b4b4b;}`;\r\n\r\nconst GamifyComponent:any = importRemoteCCClass('GamifyComponent')\r\n\r\nenum LobbyPopupStatus {\r\n    INIT,\r\n    SETUP_COMPLETED\r\n}\r\n\r\ntype LobbyPopupSate = {\r\n    status:LobbyPopupStatus,\r\n    enableLobby:boolean,\r\n    lobbyURL:string\r\n}\r\n\r\n\r\n\r\n@remoteCCClass('LobbyPopup')\r\nexport class LobbyPopup extends GamifyComponent implements IGamifyComponent {\r\n    \r\n    @property({type:Color})\r\n    buttonColor:Color = new Color();\r\n\r\n    // @property({type:SpriteAtlas})\r\n    // atlas:SpriteAtlas\r\n\r\n    @property({ type: SpriteFrame })  \r\n    homeIcon:SpriteFrame = null;  \r\n    // public get homeIcon(): SpriteFrame {\r\n    //     if(this.atlas && this._homeIcon){\r\n    //         const sp:SpriteFrame = this.atlas.getSpriteFrame(this._homeIcon.name);\r\n    //         return sp\r\n    //     }\r\n    //     return this._homeIcon;\r\n    // }\r\n\r\n    // public set homeIcon(value: SpriteFrame) {\r\n    //     if(this.atlas){\r\n    //         this._homeIcon = this.atlas.getSpriteFrame(value.name);\r\n    //         this._homeIcon\r\n    //     }else{ \r\n    //         this._homeIcon = value;\r\n    //     }\r\n    // }\r\n\r\n    @property({serializable:true})\r\n    private _homeIcon: SpriteFrame = null;\r\n\r\n    @property({type:ServiceRequestConfig})\r\n    serviceRequest:ServiceRequestConfig = null;\r\n\r\n    // @property({type:APIServiceAdaptor})\r\n    // newtworkAdaptor:APIServiceAdaptor = null;\r\n\r\n    servieNetworkName:string = null;\r\n    \r\n    private fillImgWrapper:HTMLButtonElement = null;\r\n\r\n    private lobbyURL:string;\r\n\r\n    // onStoreRegisted(state: any, action: Action): void {\r\n    //     if(action.sender == this.getStateName()){\r\n    //         console.log('-----------')            \r\n                         \r\n    //     }\r\n    // }\r\n\r\n    // onInit(readyStates?: string[]): void {\r\n       \r\n    // }\r\n\r\n    /**\r\n     * \r\n     * @param state \r\n     * @param action \r\n     */\r\n    onData(state:LobbyPopupSate, action:Action){\r\n        const actionType:string = action.type;\r\n        const payload:any = action.payload;\r\n        let networkState:any\r\n        switch(actionType){\r\n            case API_ACTION.AUTH_RESULT:\r\n                log('auth result');\r\n            case MainGameAction.INIT:                \r\n                if(payload && payload.apiService) {\r\n                    this.servieNetworkName = payload.apiService;\r\n                }\r\n                networkState = this.getAPIData(this.servieNetworkName);\r\n                state.enableLobby = (!sys.isMobile && networkState && networkState?.config && (networkState?.config?.homeButton === 'true' || networkState?.config?.homeButton === true));\r\n                // \r\n                if(state.enableLobby){\r\n                    const urlSearchParams = new URLSearchParams(window.location.search);\r\n                    state.lobbyURL = urlSearchParams.get('redirectUrl');\r\n                    if (state.lobbyURL && this.isURLValid(state.lobbyURL)) {\r\n                        state.lobbyURL = decodeURIComponent(state.lobbyURL);\r\n                        this.lobbyURL = state.lobbyURL;\r\n                        state.status = LobbyPopupStatus.SETUP_COMPLETED;\r\n                    } else {                   \r\n                        state.status = LobbyPopupStatus.INIT;\r\n                    }\r\n\r\n                    this.render();\r\n                }\r\n                \r\n            case this.serviceRequest.ResponseAction:  \r\n                networkState = this.getAPIData(this.servieNetworkName);\r\n                state.lobbyURL = networkState?.config?.lobbyURL;\r\n                this.lobbyURL = state.lobbyURL;\r\n                state.status = LobbyPopupStatus.SETUP_COMPLETED;\r\n                this.render();\r\n                break\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param done \r\n     * @param capturedState \r\n     * @param sharedData \r\n     */\r\n    async onRender(done:Function, capturedState?:LobbyPopupSate, sharedData?:any){\r\n        switch(capturedState.status){\r\n            case LobbyPopupStatus.INIT:                \r\n                this.serviceRequest.request();\r\n                break;\r\n\r\n            case LobbyPopupStatus.SETUP_COMPLETED:\r\n                this.hidePopup();\r\n                this.displayHomeButton();\r\n                this.setButtonColor(this.buttonColor.toString())  \r\n                break;\r\n        }\r\n        done();\r\n    }\r\n\r\n    //-----------------\r\n\r\n    /**\r\n     * \r\n     * @returns \r\n     */\r\n    getAPIData(serviceName:string):any{\r\n        if(serviceName){\r\n            const serviceData:any = this['getOtherState'](serviceName) as any;\r\n            if(!serviceData) {\r\n                error('[Lobby Popup]: Kh√¥ng c√≥ ho·∫∑c setup nh·∫ßm service');\r\n                return null;\r\n            }\r\n            return serviceData;\r\n        }else {            \r\n            error('[Lobby Popup] Ch∆∞a khai b√°o service name ! C√≥ th·ªÉ do StartGameAction.INIT ch∆∞a ƒë∆∞·ª£c dispatch.')\r\n        }\r\n        return null;\r\n    }\r\n\r\n    //-----------------\r\n\r\n    private isURLValid(urlStr: string): boolean {\r\n        return (urlStr != undefined && urlStr != null && urlStr != '#' && urlStr.length > 0);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param useEffect \r\n     */\r\n    private async showPopup(useEffect:boolean = false){\r\n        const uiOpacity:UIOpacity = this.node.getComponent(UIOpacity) || this.node.addComponent(UIOpacity);\r\n        this.node.children.forEach((childNode:Node)=>{            \r\n            childNode.active = true;\r\n        })\r\n        if(useEffect){\r\n            Tween.stopAllByTarget(this.node);\r\n            await new Promise((resolve: Function) => {                \r\n                tween(uiOpacity).set({\r\n                    opacity: 0\r\n                })\r\n                .to(0.4, { opacity: 255 })\r\n                .call(resolve)\r\n                .start();\r\n            });\r\n        }else{\r\n            uiOpacity.opacity = 255;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param useEffect \r\n     */\r\n    private async hidePopup(useEffect:boolean = false){\r\n        if(useEffect){\r\n            Tween.stopAllByTarget(this.node);\r\n            await new Promise((resolve: Function) => {\r\n                const uiOpacity:UIOpacity = this.node.getComponent(UIOpacity) || this.node.addComponent(UIOpacity);\r\n                tween(uiOpacity).set({\r\n                    opacity: 255\r\n                })\r\n                .to(0.4, { opacity: 0 })\r\n                .call(resolve)\r\n                .start();\r\n            });\r\n        }\r\n        // \r\n        this.node.children.forEach((childNode:Node)=>{                \r\n            childNode.active = false;\r\n        })        \r\n    }\r\n    /**\r\n     * \r\n     */\r\n    protected displayHomeButton(){\r\n        if(this.homeIcon){\r\n            const styleSheet = document.createElement(\"style\");\r\n            styleSheet.innerText = CSSButtonStyle;\r\n            document.head.appendChild(styleSheet)\r\n\r\n            // Create a wrapper div for fillImg\r\n            this.fillImgWrapper = document.createElement('button');\r\n            this.fillImgWrapper.className = 'lobbyBtn';\r\n            let fillImg = document.createElement('img');\r\n            fillImg.className = 'lobbyBtnImg';\r\n            fillImg.src = this.homeIcon.texture.toString()\r\n            fillImg.addEventListener('click', this.onHomeButtonPressed.bind(this));\r\n\r\n            this.fillImgWrapper.appendChild(fillImg); // Append fillImg to the wrapper div\r\n            document.body.appendChild(this.fillImgWrapper); // Append the wrapper div to the body\r\n\r\n\r\n        }else{\r\n\r\n        }\r\n    }\r\n\r\n    protected setButtonColor(colorStr: string) {\r\n        if (this.isLobbyEnabled && this.fillImgWrapper) {\r\n            var regex = /[0-9A-Fa-f]{6}/g;\r\n            if (colorStr.match(regex)) {\r\n                let styleSheet = document.createElement(\"style\");\r\n                styleSheet.innerText = `.lobbyBtn_1{background-color:${colorStr}}`;\r\n                document.head.appendChild(styleSheet);\r\n                this.fillImgWrapper.classList.add('lobbyBtn_1');\r\n            }\r\n            else {\r\n                log('Color string is invalid - ', colorStr);\r\n            }\r\n        }\r\n    }\r\n\r\n    // ---------\r\n\r\n    async onHomeButtonPressed() {\r\n        await this.showPopup(true);\r\n    }\r\n    \r\n    async onCancelButtonPressed(){\r\n        await this.hidePopup(true);\r\n    }\r\n\r\n    async onOKButtonPressed(){\r\n        this.hidePopup(true);\r\n        if (this.lobbyURL && this.isURLValid(this.lobbyURL)) {\r\n            //redirect\r\n            window.location.replace(this.lobbyURL);\r\n        } else {\r\n            error('Invalid redirect URL ' + this.lobbyURL);\r\n        }\r\n    }\r\n}\r\n\r\n\r\n","import { _decorator, Component, Node } from 'cc';\r\nimport { FloatButton } from '../../../../Scripts/ui/button/FloatButton';\r\nimport { SpineClip } from '../../../../Scripts/ui/anims/SpineClip';\r\nimport { EventTouch } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('PlayerInboxButton')\r\nexport class PlayerInboxButton extends FloatButton {\r\n        \r\n    @property({ type: SpineClip })\r\n    public get animation(): SpineClip {\r\n        return this._animation;\r\n    }\r\n    public set animation(value: SpineClip) {\r\n        this._animation = value;\r\n    }\r\n\r\n    // @property({serializable:true})\r\n    private _animation: SpineClip;\r\n\r\n    onLoad(): void {\r\n        super.onLoad()\r\n        if(!this.animation){\r\n            this.animation = this.getComponent(SpineClip);\r\n        }\r\n    }\r\n\r\n    async onPress(event:EventTouch){        \r\n        await this.animation.play(1);\r\n        // this.animation.play(0);\r\n        super.onPress(event);        \r\n    }\r\n\r\n    protected onEnable(): void {\r\n        this.animation.play(0);\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { _decorator, Component, Node } from 'cc';\r\nimport { InboxInfo } from '../types/PlayerInboxType';\r\nimport { Event } from 'cc';\r\nimport { Label } from 'cc';\r\nimport { Eventify } from 'cc';\r\nimport { Sprite } from 'cc';\r\nimport { Button } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('PlayerInboxItem')\r\nexport class PlayerInboxItem extends Eventify(Component) {\r\n\r\n    static EVENT = {\r\n      SELECTED:'selected_item_event'\r\n    }\r\n\r\n    @property({type:Label})\r\n    rewardTitle:Label = null;\r\n\r\n    @property({type:Label})\r\n    expireTimeTitle:Label = null;\r\n\r\n    private data:InboxInfo;\r\n    private _isActive: boolean = true;\r\n    public get isActive(): boolean {\r\n      return this._isActive;\r\n    }\r\n    public set isActive(value: boolean) {\r\n      if(this._isActive !== value){\r\n        const allSprites:Sprite[] = this.getComponentsInChildren(Sprite);\r\n        allSprites.forEach((sp:Sprite)=>sp.grayscale = !this._isActive);\r\n        (this.getComponentInChildren(Button) as Button).interactable = this._isActive;      \r\n      }\r\n      this._isActive = value;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param deltaTime \r\n     */\r\n    update(deltaTime: number) {\r\n        if(this.data && this.data.claimBefore && this.isActive){\r\n          const timeRemaining:number = this.data.claimBefore.getTime() - Date.now()\r\n          this.expireTimeTitle.string = this.convertMsToTime(timeRemaining);\r\n          this.isActive = (!this.data.isRead && timeRemaining > 1000);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param data \r\n     */\r\n    render(data:InboxInfo){\r\n        this.data = data        \r\n        this.rewardTitle.string = data.count + this.rewardTitle.string;        \r\n        \r\n\r\n        // this.isActive = false\r\n    }\r\n\r\n    onClaimReward(event:Event){\r\n        this.emit(PlayerInboxItem.EVENT.SELECTED, this.data)\r\n    }\r\n\r\n\r\n\r\n    // ---------------------\r\n\r\n    private updateExpireTime(){\r\n\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param milliseconds \r\n     * @returns \r\n     */\r\n    private convertMsToTime(milliseconds: number) {\r\n        if(!this.isActive)\r\n          return `00d:00h:00m:00s`;\r\n          \r\n        let seconds:number = Math.floor(milliseconds / 1000);\r\n        let minutes:number = Math.floor(seconds / 60);\r\n        let hours:number = Math.floor(minutes / 60);\r\n        let days:number = Math.floor(hours / 24);\r\n    \r\n        seconds = seconds % 60;\r\n        minutes = minutes % 60;\r\n    \r\n        // üëáÔ∏è If you don't want to roll hours over, e.g. 24 to 00\r\n        // üëáÔ∏è comment (or remove) the line below\r\n        // commenting next line gets you `24:00:00` instead of `00:00:00`\r\n        // or `36:15:31` instead of `12:15:31`, etc.\r\n        hours = hours % 24;\r\n    \r\n        if (seconds < 0)\r\n          return `00d:00h:00m:00s`;\r\n    \r\n        return `${this.padTo2Digits(days)}d:${this.padTo2Digits(hours)}h:${this.padTo2Digits(minutes)}m:${this.padTo2Digits(seconds)}s`;\r\n      }\r\n    \r\n    private padTo2Digits(num: number) {\r\n      return num.toString().padStart(2, '0');\r\n    }\r\n\r\n    // ---------------------\r\n    protected onDestroy(): void {\r\n      this.targetOff(this)\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { _decorator, Component, Node } from 'cc';\r\nimport { WebSocketComponent } from '../../../../Scripts/ui/network/WebSocketComponent';\r\nimport { Action } from '../../../../Scripts/gamify/core/Action';\r\nimport { ServiceRequestConfig } from '../../../../Scripts/ui/api/ServiceRequestConfig';\r\nimport { MainGameAction } from '../../../../Scripts/ui/actions/StartActions';\r\nimport { error } from 'cc';\r\nimport { log } from 'cc';\r\nimport { Helper } from '../../../../Scripts/gamify/utils/Helper';\r\nimport { js } from 'cc';\r\nimport { InboxInfo, PlayerInboxAction } from '../types/PlayerInboxType';\r\nimport { EventHandler } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n\r\n\r\ntype PlayerInboxState = {\r\n    status:number,\r\n    data?:InboxInfo[]\r\n    // error?:\r\n}\r\n\r\n\r\n\r\nenum PlayerInboxNetworkState {\r\n    INIT,\r\n    READY\r\n}\r\n\r\n@ccclass('PlayerInboxNetwork')\r\nexport class PlayerInboxNetwork extends WebSocketComponent {\r\n\r\n    private servieNetworkName:string = null;\r\n\r\n    /**\r\n     * \r\n     * @param state \r\n     * @param action \r\n     */\r\n    onData(state:any, action:Action){\r\n        const actionType:string = action.type;\r\n        const payload:any = action.payload;\r\n        switch(actionType){\r\n            case MainGameAction.INIT: \r\n                if(payload && payload.apiService) {\r\n                    this.servieNetworkName = payload.apiService;\r\n                }\r\n                this.initNetworkState(state);                \r\n                break\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param done \r\n     * @param capturedState \r\n     * @param sharedData \r\n     */\r\n    async onRender(done: Function, capturedState?: any, sharedData?: any): Promise<void> {\r\n        switch(capturedState.status){\r\n            case PlayerInboxNetworkState.INIT:\r\n                await this.connect(this._url);\r\n                break;\r\n        }\r\n        done && done();\r\n    }\r\n\r\n\r\n    // // ---------------\r\n\r\n    /**\r\n     * \r\n     * @returns \r\n     */\r\n    private async initNetworkState(state:PlayerInboxState){\r\n        if(!this.servieNetworkName) return;\r\n        const networkState:any = this.getAPIData(this.servieNetworkName);    \r\n        this._url = networkState.config.wssURL;\r\n        state.status = PlayerInboxNetworkState.INIT;\r\n        this.render();\r\n    }\r\n\r\n    // ------------- REQUEST PARAMS --------------\r\n\r\n    /**\r\n     * This funtion using for handler the params tranfer to service config.\r\n     * @param state \r\n     * @param paramKey \r\n     * @returns the string which passed to {paramKey} of request.\r\n     */\r\n    getStartDateParam(state:any, paramKey:string):string{\r\n        const date:Date = new Date();\r\n        return new Date(date.getFullYear(), date.getMonth(), date.getDate()).toISOString();        \r\n    }\r\n    \r\n    /**\r\n     * This funtion using for handler the params tranfer to service config.\r\n     * @param state \r\n     * @param paramKey \r\n     * @returns the string which passed to {paramKey} of request.\r\n     */\r\n    getEndDateParam(state:any, paramKey:string):string{\r\n        return new Date().toISOString();\r\n    }\r\n\r\n    // ---------------\r\n\r\n   /**\r\n    * \r\n    * @param serviceName \r\n    * @returns \r\n    */\r\n    protected getAPIData(serviceName:string):any{\r\n        if(serviceName){\r\n            const serviceData:any = this['getOtherState'](serviceName) as any;\r\n            if(!serviceData) {\r\n                error('[Lobby Popup]: Kh√¥ng c√≥ ho·∫∑c setup nh·∫ßm service');\r\n                return null;\r\n            }\r\n            return serviceData;\r\n        }else {            \r\n            error('[Lobby Popup] Ch∆∞a khai b√°o service name ! C√≥ th·ªÉ do StartGameAction.INIT ch∆∞a ƒë∆∞·ª£c dispatch.')\r\n        }\r\n        return null;\r\n    }\r\n    // ---------------\r\n\r\n    /**\r\n     * \r\n     * @param client \r\n     * @param event \r\n     */\r\n    onMessage(client:WebSocket, event:MessageEvent){\r\n        super.onMessage(client, event)\r\n        this.dispatch({type:PlayerInboxAction.UPDATE_INBOX})\r\n        // if(event.data){\r\n            \r\n        // }\r\n    }\r\n\r\n    \r\n    /**\r\n     * \r\n     * @param client \r\n     * @param event \r\n     */\r\n    onError(client:WebSocket, event:Event){\r\n        super.onError(client, event)\r\n    }\r\n}\r\n\r\n\r\n","import { _decorator, Component, Node } from 'cc';\r\nimport { GamePopup } from '../../../Scripts/ui/popup/GamePopup';\r\nimport { Prefab } from 'cc';\r\nimport { ServiceRequestConfig } from '../../../Scripts/ui/api/ServiceRequestConfig';\r\nimport { Action } from '../../../Scripts/gamify/core/Action';\r\nimport { API_ACTION, MainGameAction } from '../../../Scripts/ui/actions/StartActions';\r\nimport { ClaimInfo, InboxInfo, PlayerInboxAction, PlayerInboxBetSetting, PlayerInboxState, PlayerInboxStatus } from './types/PlayerInboxType';\r\nimport { error } from 'cc';\r\nimport { js } from 'cc';\r\n// import { Helper } from '../../../Scripts/gamify/utils/Helper';\r\nimport { WebSocketComponent } from '../../../Scripts/ui/network/WebSocketComponent';\r\nimport { instantiate } from 'cc';\r\nimport { PlayerInboxItem } from './ui/PlayerInboxItem';\r\nimport { log } from 'cc';\r\nimport { RemoteMultilingualTextPackage } from '../../../Scripts/ui/l10n/plugins/RemoteMultilingualTextPackage';\r\nimport { Event } from 'cc';\r\nimport { warn } from 'cc';\r\nimport { AsyncWaitify } from '../../../Scripts/gamify/master/AsyncWaitify';\r\n// import { PlayButtonState, PlayMode } from '../../../Scripts/ui/button/PlayButton';\r\nimport { Label } from 'cc';\r\nimport { remoteCCClass } from '../../../Scripts/gamify/utils/RemoteScriptImporter';\r\nconst { ccclass, property } = _decorator;\r\n\r\n// const RemoteMultilingualTextPackage = js.getClassByName('RemoteMultilingualTextPackage');\r\n// const AsyncWaitify = js.getClassByName('AsyncWaitify');\r\nconst Helper:any = js.getClassByName('Helper');\r\n// const ServiceRequestConfig = js.getClassByName('ServiceRequestConfig');\r\n// const Action = js.getClassByName('Action');\r\n// const GamePopup = js.getClassByName('GamePopup');\r\n\r\n@remoteCCClass('PlayerInboxPopup')\r\n// @ccclass('PlayerInboxPopup')\r\nexport class PlayerInboxPopup extends AsyncWaitify(GamePopup) {\r\n\r\n\r\n    @property({readonly:true})\r\n    waitForStore:string = 'PlayButton';\r\n    \r\n    @property({\r\n        type:Node,\r\n        group:'PANEL'\r\n    })\r\n    curtain:Node = null;\r\n    \r\n    @property({\r\n        type:Node,\r\n        group:'PANEL'\r\n    })\r\n    closeButton:Node = null;\r\n\r\n    @property({\r\n        type:Node,\r\n        group:'PANEL'\r\n    })\r\n    dragButton:Node = null;\r\n\r\n    @property({\r\n        type:Node,\r\n        group:'PANEL'\r\n    })\r\n    continueNotication:Node = null;\r\n\r\n    @property({\r\n        type:Node,\r\n        group:'PANEL'\r\n    })\r\n    playerInboxPanel:Node = null;\r\n    \r\n    \r\n    @property({\r\n        type:Node,\r\n        group:'PANEL',\r\n        displayName:'|__ Content'\r\n    })\r\n    inboxContainer:Node = null;\r\n\r\n    @property({\r\n        type:Prefab,\r\n        group:'ASSETS',\r\n        displayName:'Item Prefab'\r\n    })\r\n    itemPrefab:Prefab = null;\r\n    \r\n    @property({\r\n        type:RemoteMultilingualTextPackage,\r\n        group:'ASSETS',\r\n        displayName:'Language Package'\r\n    })\r\n    languagePackage:RemoteMultilingualTextPackage = null;\r\n    \r\n    @property({\r\n        type:Node,\r\n        group:'PANEL',\r\n        displayName:'|__ Prepaid Panel'\r\n    })\r\n    prepaidPanel:Node = null;\r\n    \r\n    @property({\r\n        type:Node,\r\n        group:'PANEL',\r\n        displayName:'|__ CashDrop Panel'\r\n    })\r\n    cashDropPanel:Node = null;\r\n    \r\n    @property({\r\n        type:Label,\r\n        group:'PANEL',\r\n        displayName:'|__ Empty Notication'\r\n    })\r\n    emptyNotication:Label = null;\r\n\r\n    @property({\r\n        type:ServiceRequestConfig,\r\n        group:'NETWORK',\r\n    })\r\n    listingService:ServiceRequestConfig = null;\r\n    \r\n    @property({\r\n        type:ServiceRequestConfig,\r\n        group:'NETWORK',\r\n    })\r\n    claimService:ServiceRequestConfig = null;\r\n\r\n    public allowActionTypes(): string[] {\r\n        return [\r\n            MainGameAction.INIT,\r\n            MainGameAction.SETTING,\r\n            PlayerInboxAction.UPDATE_INBOX,\r\n            PlayerInboxAction.CLAIM,\r\n            PlayerInboxAction.SHOW,\r\n            PlayerInboxAction.HIDE\r\n        ]\r\n    }\r\n\r\n\r\n    private _selectedItemInfo:InboxInfo;\r\n\r\n    private servieName:string = 'APIService';\r\n\r\n    private _continue:Function;\r\n\r\n    onInit(readyStates?:string[]){\r\n        // if(readyStates.findIndex((fullStateName:string)=>fullStateName.indexOf('<' +this.waitForStore+ '>') !== -1) !== -1){\r\n        //     // Truong hop PlayButton khoi tao truoc PlayerInBoxPopup\r\n        //     // log('[1]. Truong hop PlayButton khoi tao truoc PlayerInBoxPopup')\r\n        //     this.ready();\r\n        // }        \r\n        this.waitForReady().then(()=>{\r\n            this.dispatch({type:PlayerInboxAction.SHOW, payload:{status: PlayerInboxStatus.SHOW_ICON_VIEW}});\r\n        })\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param state \r\n     * @param action \r\n     */\r\n    onStoreRegisted(state: any, action: Action): any {\r\n        // Kiem tra khi PlayButton load xong.\r\n        if( (this.senderIsMe() && this.hasOtherState(this.waitForStore)) || ((action.sender.indexOf(this.waitForStore) !== -1))){\r\n            this.ready();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param state \r\n     * @param action \r\n     */\r\n    onData(state:PlayerInboxState, action:Action){\r\n        const actionType:string = action.type;\r\n        const payload:any = action.payload;\r\n        switch(actionType){\r\n            case MainGameAction.INIT:\r\n                if(payload && payload.apiService) {\r\n                    this.servieName = payload.apiService;\r\n                }\r\n                // \r\n                this.servieName = payload.apiService;\r\n                this.checkAndUpdateClaimmingState(state);                \r\n                break;\r\n                \r\n            case MainGameAction.SETTING:\r\n                this.implementSettingState(state, action)\r\n                break;\r\n\r\n            case PlayerInboxAction.UPDATE_INBOX:\r\n                state.status = PlayerInboxStatus.SHOW_INBOX_VIEW;\r\n                this.render(true);\r\n                state.status = PlayerInboxStatus.READY;\r\n                break;            \r\n           \r\n            case PlayerInboxAction.SHOW:\r\n                if(payload && (js.isNumber(payload.status) || !!payload.status)){\r\n                    state.status = payload.status\r\n                }\r\n                this.render();\r\n                break;\r\n\r\n            case PlayerInboxAction.HIDE:\r\n                state.status = PlayerInboxStatus.HIDE_VIEW;\r\n                this.render();\r\n                break;\r\n\r\n            case PlayerInboxAction.CLAIM:\r\n                if(payload){\r\n                    state.status = PlayerInboxStatus.CLAIM;\r\n                    if(!state.claimed) {state.claimed = Object.create(null);}\r\n                    state.claimed.url = payload.url;\r\n                    state.claimed.data = payload.data as ClaimInfo;\r\n                }\r\n                this.render();\r\n                break;\r\n        }\r\n        \r\n    }\r\n\r\n\r\n    /**\r\n     * \r\n     * @param done \r\n     * @param capturedState \r\n     * @param sharedData \r\n     */\r\n    async onRender(done: Function, capturedState?: PlayerInboxState, sharedData?: any): Promise<void> {   \r\n        //  Note: capturedState only exists during the rendering process. When finished it will disappear. \r\n        // (Chu √Ω: capturedState chi t·ªìn t·∫°i trong su·ªët qu√° tr√¨nh render. Khi k·∫øt th√∫c n√≥ s·∫Ω bi·∫øn m·∫•t.)\r\n        switch(capturedState.status){           \r\n\r\n            case PlayerInboxStatus.SHOW_ICON_VIEW:\r\n                await this.showIconViewRender(capturedState);\r\n                break;\r\n\r\n            // case PlayerInboxStatus.INIT:\r\n            case PlayerInboxStatus.SHOW_INBOX_VIEW:\r\n                await this.showInboxViewRender(capturedState);\r\n                await this.requestInboxStateRender();\r\n                break;\r\n\r\n            case PlayerInboxStatus.HIDE_VIEW:\r\n                // await this.showIconViewRender(capturedState);\r\n                break;\r\n\r\n            case PlayerInboxStatus.CLAIM:\r\n                await this.requestClaimmingStateRender(capturedState);\r\n                await this.showIconViewRender(capturedState);\r\n                await this.updateAutoSpinSettingRender(capturedState);                \r\n                break\r\n                \r\n            case PlayerInboxStatus.SHOW_CONTINUE_VIEW:\r\n                await this.showContinuePopupRender(capturedState);                \r\n                await this.updateAutoSpinSettingRender(capturedState);   \r\n                // await this.executeSpinStateRender(capturedState);\r\n                await this.showIconViewRender(capturedState);\r\n                break;\r\n\r\n            case PlayerInboxStatus.UPDATE:\r\n                await this.updateAutoSpinSettingRender(capturedState);\r\n                // await this.showIconViewRender(capturedState);\r\n                break;\r\n\r\n            case PlayerInboxStatus.AUTO_SPIN:\r\n                await this.executeSpinStateRender(capturedState);\r\n                break;\r\n        }\r\n        done && done();\r\n    }\r\n\r\n    // ------------------\r\n    \r\n    /**\r\n     * \r\n     * @param state \r\n     */\r\n    private checkAndUpdateClaimmingState(state:PlayerInboxState){        \r\n        if(!this.servieName) return;\r\n        const networkState:any = this.getOtherState(this.servieName);\r\n        const playerReward:any = this.getClaimedRewards(networkState);\r\n        const claimedInfo:ClaimInfo = this.getClaimInfoFromRewardData(playerReward);\r\n        // \r\n        if(claimedInfo){\r\n            if(!state.claimed) state.claimed = Object.create(null);\r\n            state.claimed.data = claimedInfo || null;\r\n            state.status = PlayerInboxStatus.SHOW_CONTINUE_VIEW;\r\n            this.render(true);            \r\n        }\r\n        state.status = PlayerInboxStatus.READY;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param state \r\n     */\r\n    private implementSettingState(state:PlayerInboxState, action:Action){\r\n        if(this.senderIsMe()){     \r\n            if(!this.isStoreRegisted(this.waitForStore)){   \r\n                warn('implementSettingState----------- store ' + this.waitForStore + ' chua duoc khai tao')\r\n            } \r\n            this.waitFor(this.waitForStore);\r\n            const claimedInfo: {\r\n                url: string;\r\n                data: ClaimInfo;\r\n            } = state.claimed;\r\n            // const playButtonState:PlayButtonState = this.getOtherState(this.waitForStore);\r\n            // // && playButtonState.mode == PlayMode.NORMAL\r\n            if(claimedInfo && claimedInfo.data && !!claimedInfo.data?.count && claimedInfo.data?.count > 0){                \r\n                const lastStatus:PlayerInboxStatus = state.status;\r\n                state.status = PlayerInboxStatus.AUTO_SPIN;\r\n                this.render(true);\r\n                state.status = lastStatus;\r\n                state.claimed = null;\r\n            }\r\n        }else{\r\n            // log('settign from ' + action.sender)\r\n        }\r\n    }\r\n\r\n    // ------------------\r\n\r\n    \r\n\r\n    // ------------------------------------------\r\n\r\n    /**\r\n     * \r\n     */\r\n    private async requestInboxStateRender(){\r\n        const networkState:any = await this.listingService.request();\r\n        await this.renderInboxList(networkState);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param capturedState \r\n     */\r\n    private async requestClaimmingStateRender(capturedState:PlayerInboxState){\r\n        if(!this.isStoreRegisted(this.waitForStore)){\r\n            await this.waitForReady();\r\n        }\r\n        const claimUrl:string = capturedState?.claimed?.url;\r\n        const claimedInfo:ClaimInfo = capturedState?.claimed?.data as ClaimInfo;\r\n        if(claimedInfo && claimUrl && claimUrl.length){            \r\n            const networkState:any = await this.claimService.request([{url:claimUrl}]);\r\n            if(!networkState) {\r\n                error('[PlayerInboxPopup]::checkAndSetupPlayerInboxSetting(...): Do not found state data via \\\"servieName\\\" '); \r\n                return;\r\n            }\r\n            // \r\n            const playerReward:any = this.getClaimedRewards(networkState);\r\n            const claimedInfo:ClaimInfo = this.getClaimInfoFromRewardData(playerReward);            \r\n            if(!capturedState.claimed) capturedState.claimed = Object.create(null);\r\n            capturedState.claimed.data = claimedInfo;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param rewardCount \r\n     * @param betSetting \r\n     */\r\n    protected async updateAutoSpinSettingRender(state:PlayerInboxState){        \r\n        const claimedInfo:ClaimInfo = state?.claimed?.data;\r\n        if(claimedInfo){            \r\n            const rewardCount:number = claimedInfo.count;\r\n            const betSetting:PlayerInboxBetSetting = claimedInfo.betSetting;\r\n            const isUnstopable:boolean = (!!rewardCount && rewardCount > 0);\r\n\r\n            if(!this.isStoreRegisted(this.waitForStore)){\r\n                await this.waitForReady();\r\n            }\r\n\r\n            this.dispatch({type:MainGameAction.SETTING, payload: {     \r\n                isUnstoppable:isUnstopable,         \r\n                autoSpinNumber: rewardCount,\r\n                betConfig: betSetting\r\n            }});        \r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * \r\n     * @param state \r\n     */\r\n    private async executeSpinStateRender(state:PlayerInboxState){\r\n        if(!this.isStoreRegisted(this.waitForStore)){  \r\n            await this.waitForReady();\r\n        }\r\n        this.dispatch({type:API_ACTION.SPIN});\r\n        // state.claimed = null;\r\n        // this.setState(state);\r\n    }\r\n    \r\n\r\n    // ------------------------------------------\r\n\r\n    /**\r\n     * \r\n     * @param state \r\n     */\r\n    private async showContinuePopupRender(state:PlayerInboxState){\r\n        this.curtain.active = true;\r\n        this.playerInboxPanel.active = false;\r\n        this.closeButton.active = false;\r\n        this.continueNotication.active = true;\r\n        this.dragButton.active = false;\r\n        await new Promise((resolve:Function)=>{\r\n            this._continue = resolve;\r\n        })\r\n    }\r\n\r\n\r\n    /**\r\n     * \r\n     * @param state \r\n     */\r\n    private async showInboxViewRender(state?:PlayerInboxState){\r\n        this.curtain.active = true;\r\n        this.playerInboxPanel.active = true;\r\n        this.closeButton.active = true;        \r\n        this.continueNotication.active = false;\r\n        this.dragButton.active = false;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param state \r\n     */\r\n    private async showIconViewRender(state?:PlayerInboxState){\r\n        this.curtain.active = false;        \r\n        this.playerInboxPanel.active = false;\r\n        this.closeButton.active = false;\r\n        this.continueNotication.active = false;\r\n        this.dragButton.active = true;\r\n    }\r\n\r\n        \r\n    // --------------- PRIVATE ---------------------\r\n\r\n    /**\r\n     * \r\n     * @param networkState \r\n     * @returns \r\n     */\r\n    private getClaimedRewards(networkState:any):any{\r\n        if(!networkState) return;\r\n        let claimedReward:any = Helper.searchValue(networkState, 'config.playerReward');\r\n        if(Array.isArray(claimedReward)){\r\n            claimedReward = (claimedReward as any[]).find((reward:any)=> reward.status == \"CLAIMED\");\r\n        }\r\n        return claimedReward;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param networkState \r\n     * @returns \r\n     */\r\n    private getPlayMode(networkState:any):number{\r\n        const spinData:any = networkState?.spin;\r\n        if(spinData){\r\n            const numOfFreeSpin:number = spinData.freeSpins || 0;\r\n            return (numOfFreeSpin && numOfFreeSpin > 0) ? 1 : 0; // 1: FreeSpin , 0: Normal Spin\r\n        }\r\n        return 0\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param claimRewardData \r\n     */\r\n    private getClaimInfoFromRewardData(playerReward:any):ClaimInfo{\r\n        if(!playerReward) return null;\r\n        const id:string = Helper.searchValue(playerReward, 'id');       \r\n        const rewardCount:number = playerReward.rewardCount || Helper.searchValue(playerReward, 'reward.count') || 0;\r\n        let rewardData:any = Helper.searchValue(playerReward, 'reward.data');\r\n        if(rewardData){\r\n            rewardData = js.isString(rewardData) ? JSON.parse(rewardData) : rewardData;\r\n        }\r\n        // Update auto spin number\r\n        const betSetting:PlayerInboxBetSetting = rewardData ? Helper.searchValue(rewardData, 'betSetting') : null;         \r\n        // \r\n        if(betSetting && id){\r\n            return {\r\n                claimId: id,\r\n                betSetting: betSetting,\r\n                count: rewardCount\r\n            } as ClaimInfo\r\n        }\r\n        return null\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param state \r\n     */      \r\n    protected async renderInboxList(networkState:any){\r\n        if(networkState?.config?.playerInbox){\r\n            const data:any[] = networkState?.config?.playerInbox.data;  // data of inbox_history\r\n            const domain:string = Helper.searchValue(networkState?.config, 'domain');\r\n            const playerToken:string = Helper.searchValue(networkState?.config, 'playerToken');\r\n            // \r\n            if(this.emptyNotication) { \r\n                this.emptyNotication.node.active = !(data && data.length);\r\n            }\r\n            // \r\n            if(data && data.length){\r\n                const now = new Date().getTime(); // Get the current date and time \r\n                const inboxList:InboxInfo[] = [];\r\n                data.forEach((elementData:any, index:number)=>{\r\n                    const inboxInfo:InboxInfo = js.createMap();\r\n                    // Pick data field from network data.\r\n                    inboxInfo.id = index;\r\n                    inboxInfo.claimId = Helper.searchValue(elementData, 'id');\r\n                    inboxInfo.module = Helper.searchValue(elementData, 'module');\r\n                    inboxInfo.isRead = !!Helper.searchValue(elementData, 'isRead');\r\n                    inboxInfo.claimBefore = new Date(Helper.searchValue(elementData, 'claimBefore'));\r\n                    inboxInfo.claimUrl  = domain + Helper.searchValue(elementData, 'claimUrl') + playerToken;\r\n                    inboxInfo.count  = Helper.searchValue(elementData, 'extraInfo.reward.count');\r\n                    // inboxInfo.gameMode  = Helper.searchValue(elementData, 'extraInfo.reward.data.gameMode.type'); // Optional, do not need.\r\n                    inboxInfo.betSetting = Helper.searchValue(elementData, 'extraInfo.reward.data.betSetting');\r\n                    // \r\n                    inboxList.push(inboxInfo);\r\n                })\r\n                if(inboxList.length) {\r\n                    inboxList.sort((a:InboxInfo, b:InboxInfo)=>{\r\n                        const timeA = new Date(a.claimBefore).getTime();\r\n                        const timeB = new Date(b.claimBefore).getTime();\r\n                        // Compare the 'created' times\r\n                        if (timeA < now && timeB < now) {\r\n                            return 0; // Keep the order unchanged if both times are less than the current time\r\n                        } else if (timeA < now) {\r\n                            return 1; // 'a' should be placed at the end of the array\r\n                        } else if (timeB < now) {\r\n                            return -1; // 'b' should be placed at the end of the array\r\n                        } else {\r\n                            return (timeA - timeB); // Compare times in ascending order\r\n                        }\r\n                    })\r\n                    // \r\n                    // await this.activeViewRender();\r\n                    await this.updateInboxHistoryRender(inboxList);\r\n                }\r\n                // \r\n            }else{\r\n                warn('Empty Inbox !!!')\r\n            }\r\n            //\r\n\r\n            // \r\n        }else{\r\n            warn('There is no data for networkState.config.playerInbox');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param inboxList \r\n     */\r\n    private async updateInboxHistoryRender(inboxList:InboxInfo[]){\r\n        if(this.inboxContainer && this.itemPrefab){\r\n            if(this.languagePackage){\r\n                await this.languagePackage.waitForReady();\r\n            }\r\n            this.inboxContainer.removeAllChildren();\r\n            inboxList.forEach((data:InboxInfo)=>{\r\n                const itemName:string = data.claimId;\r\n                let itemNode:Node = this.inboxContainer.getChildByName(itemName);\r\n                if(!itemNode){\r\n                    itemNode= instantiate(this.itemPrefab);\r\n                    itemNode.parent = this.inboxContainer;\r\n                    itemNode.name = itemName;\r\n                }\r\n                // \r\n                const item:PlayerInboxItem = itemNode.getComponent(PlayerInboxItem);\r\n                item.on(PlayerInboxItem.EVENT.SELECTED, this.onClaimItem.bind(this));\r\n                item.render(data);\r\n                // \r\n            })\r\n        }\r\n    }\r\n\r\n    // -----------------\r\n    \r\n    /**\r\n     * \r\n     * @param itemInfo \r\n     */\r\n    protected async onClaimItem(itemInfo:InboxInfo){        \r\n        // if(this._selectedItemInfo == itemInfo) return;\r\n        // \r\n        if(this.claimService){\r\n            const claimedInfo:ClaimInfo = {\r\n                claimId: itemInfo.claimId,\r\n                count: itemInfo.count,\r\n                betSetting: itemInfo.betSetting\r\n            }\r\n            // \r\n            this.dispatch({type:PlayerInboxAction.CLAIM, payload:{\r\n                url: itemInfo.claimUrl,\r\n                data: claimedInfo                \r\n            }});\r\n            //           \r\n        }else{\r\n            error('No service config \\\"claimService\\\"');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param event \r\n     */\r\n    protected onPressIconButton(event:Event){\r\n        this.dispatch({type:PlayerInboxAction.SHOW, payload:{status: PlayerInboxStatus.SHOW_INBOX_VIEW} });\r\n    }\r\n    \r\n    /**\r\n     * \r\n     * @param event \r\n     */\r\n    protected onPressCloseButton(event:Event){\r\n        this.dispatch({type:PlayerInboxAction.SHOW, payload:{status: PlayerInboxStatus.SHOW_ICON_VIEW}});\r\n    }\r\n\r\n    protected onPressOkButton(event:Event){\r\n        if(this._continue){\r\n            this._continue();\r\n        }\r\n        // this.dispatch({type:PlayerInboxAction.SHOW, payload:{status: PlayerInboxStatus.SHOW_INBOX_VIEW} });\r\n    }\r\n\r\n    // -----------------\r\n    /**\r\n     * This funtion using for handler the params tranfer to service config.\r\n     * @param state \r\n     * @param paramKey \r\n     * @returns the string which passed to {paramKey} of request.\r\n     */\r\n    getStartDateParam(state:any, paramKey:string):string{\r\n        const date:Date = new Date();\r\n        return new Date(date.getFullYear(), date.getMonth(), date.getDate()).toISOString();        \r\n    }\r\n    \r\n    /**\r\n     * This funtion using for handler the params tranfer to service config.\r\n     * @param state \r\n     * @param paramKey \r\n     * @returns the string which passed to {paramKey} of request.\r\n     */\r\n    getEndDateParam(state:any, paramKey:string):string{\r\n        return new Date().toISOString();\r\n    }\r\n\r\n    /**\r\n     * This funtion using for handler the params tranfer to service config.\r\n     * @param state \r\n     * @param paramKey \r\n     * @returns \r\n     */\r\n    getCurrentRewardId(state:any, paramKey:string):string{        \r\n        return (this._selectedItemInfo) ? this._selectedItemInfo.claimId : undefined\r\n    }\r\n\r\n    /**\r\n     * This funtion using for handler the params tranfer to service config.\r\n     * @param state \r\n     * @param paramKey \r\n     * @returns \r\n     */\r\n    getCurrentModule(state:any, paramKey:string):string{\r\n        return (this._selectedItemInfo) ? this._selectedItemInfo.module : undefined\r\n    }\r\n\r\n    getIsFunParam(state:any, paramKey:string):string{\r\n        return 'false'\r\n    }\r\n    // -----------------\r\n    /**\r\n     * \r\n     * @returns \r\n     */\r\n    protected getAPIData():any{\r\n        const serviceData:any = this.getOtherState(this.servieName);\r\n        if(!serviceData) {\r\n            error('Kh√¥ng c√≥ ho·∫∑c setup nh·∫ßm service');\r\n            return null;\r\n        }\r\n        return serviceData;\r\n    }\r\n    // -----------------\r\n\r\n}\r\n\r\n\r\n","export type PlayerInboxResponse = {\r\n    items:InboxInfo[]\r\n    count?:number,\r\n    page?:number,\r\n    pageCount?:number,\r\n    size?: number,\r\n    total?: number\r\n}\r\n\r\nexport type ClaimInfo = {\r\n    claimId:string,\r\n    count:number,\r\n    betSetting:PlayerInboxBetSetting,\r\n}\r\n\r\nexport type InboxInfo = {\r\n    id:number,\r\n    claimId:string,\r\n    gameMode:string,\r\n    module:string,\r\n    isRead:boolean,\r\n    // count:number,\r\n    // betSetting:PlayerInboxBetSetting,\r\n    claimUrl:string,\r\n    claimBefore:Date\r\n} & ClaimInfo\r\n\r\n\r\n\r\nexport type PlayerInboxBetSetting = {\r\n    betSize: number, \r\n    betLevel: number, \r\n    baseBet: number, \r\n    betAmount: number\r\n}\r\n\r\nexport type PlayerInboxState = {\r\n    status:number,\r\n    // gameMode?:number,\r\n    claimed:{\r\n        url:string\r\n        data: ClaimInfo\r\n    },\r\n    // rewardCount?:number\r\n}\r\n\r\nexport enum PlayerInboxStatus {\r\n    INIT,\r\n    READY,\r\n    UPDATE,    \r\n    SHOW_CONTINUE_VIEW,\r\n    SHOW_ICON_VIEW,\r\n    SHOW_INBOX_VIEW,    \r\n    HIDE_VIEW,\r\n    CLAIM,\r\n    AUTO_SPIN\r\n}\r\n\r\nexport const PlayerInboxAction = {\r\n    UPDATE_INBOX:'player_inbox_update_inbox_action',\r\n    UPDATE_SETTING:'player_inbox_update_setting_action',\r\n    SHOW:'player_inbox_show_action',\r\n    HIDE:'player_inbox_hide_action',\r\n    CLAIM:'player_inbox_claim_action',\r\n}"]}